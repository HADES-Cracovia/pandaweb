<?xml version="1.0"  encoding="utf-8" ?>
<TrbNetEntity xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:noNamespaceSchemaLocation="../schema/TrbNetEntity.xsd"
              name="Nxyter"
              address="8000"
              >
  <description>Registers for the Nxyter Readout</description>

  
  <!-- ##################################################################### -->

  <group name="TriggerHandler"
         address="0160"  size="7"  purpose="config"  mode="rw"  continuous="true">
    
    <register name="TestPulseEnable" address="0000" purpose="config">
      <description>Enable test pulse</description>
      <field name="TestPulseEnable" start="0" bits="1" format="boolean"/>
    </register>  

    <register name="TestPulseDelay" address="0001" purpose="config">
      <description>Delay of the Testpulse after Trigger</description>
      <field name="TestPulseDelay" start="0" bits="12" format="unsigned" unit="ns" scale="4"/>
    </register>   

    <register name="TestPulseLength" address="0002" purpose="config">
      <description>Length of Trigger TestPulse</description>
      <field name="TestPulseLength" start="0" bits="12" format="unsigned" unit="ns" scale="4"/>
    </register>   
    
    <register name="InvalidTriggerCount" address="0003" purpose="status" mode="r">
      <description>Invalid Timing Trigger counter</description>
      <field name="InvalidTriggerCount" start="0" bits="16" format="unsigned"/>
    </register>   
    
    <register name="TriggerRate" address="0004" purpose="status" mode="r">
      <description>Accepted incoming Trigger Rate (Hz)</description>
      <field name="TriggerRate" start="0" bits="28" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;"/>
    </register>   

    <register name="TestpulseRate" address="0005" purpose="status" mode="r">
      <description>Outgoing Testpulse Rate (Hz)</description>
      <field name="TestpulseRate" start="0" bits="28" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;"/>
    </register>   

    <register name="CTSBypass" address="0006" purpose="config" mode="rw">
      <description>Bypass/ignore CTS Timing Triggers</description>
      <field name="CTSBypass" start="0" bits="1" format="boolean" />
    </register>   
   
  </group>  

  <!-- ##################################################################### -->
  <group name="TriggerGenerator"
         address="0140"  size="5"  purpose="status"  mode="rw"  continuous="true">
     
    <register name="TrigSetup" address="0000" purpose="config" mode="rw">
      <description>Trigger Selection</description>
      <field name="InternOut"  start="2" bits="1" format="bitmask"/>
      <field name="PulserOn"   start="1" bits="1" format="bitmask"/>
      <field name="SelfTrigOn" start="0" bits="1" format="bitmask"/>
    </register>
    
    <register name="PulserT" address="0001" purpose="config" mode="rw">
      <description>Pulser Period (10ns)</description>
      <field name="PulserT" start="0" bits="28" format="unsigned"/>
    </register>

    <register name="SelfTrigRate" address="0002" purpose="status" mode="r">
      <description>Self Trigger Rate (Hz)</description>
      <field name="SelfTrigRate" start="0" bits="28" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;"/>
    </register>

    <register name="PulserRate" address="0003" purpose="status" mode="r">
      <description>Pulser Trigger Rate (Hz)</description>
      <field name="PulserRate" start="0" bits="28" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;"/>
    </register>   
    
    <register name="OutTriggerRate" address="0004" purpose="status" mode="r">
      <description>Outgoing Trigger Rate (Hz)</description>
      <field name="OutTriggerRate" start="0" bits="28" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;"/>
    </register>   

  </group> 

  <!-- ##################################################################### -->

  <group name="TriggerValidate"
         address="0400"  size="34"  purpose="config"  mode="rw"  continuous="true">
    <register name="ReadoutMode" address="0000" purpose="config">
      <description>Readout mode selection</description>

      <field name="SelfTrigger" start="3" bits="1" format="boolean">
        <description>Self Trigger Mode</description>
      </field>
      
      <field name="TSSelectOff" start="2" bits="1" format="boolean">
        <description>TimeStamp Selection Filter Off</description>
      </field>

      <field name="StatusSelect" start="0" bits="2" format="enum">
        <description>Timestamp Selection Mode</description>
        <enumItem value="0">TS 11Bit, ADC 12Bit, PileUp + Parity Bits</enumItem>
        <enumItem value="1">TS 12Bit, ADC 11Bit, PileUp + Parity Bits</enumItem>
        <enumItem value="2">TS 14Bit, ADC  9Bit, PileUp + Parity Bits</enumItem>
        <enumItem value="3">TS 14Bit, ADC 11Bit</enumItem>
      </field>
    </register>    

    <register name="TriggerWindowOffset" address="0001" purpose="config">
      <description>Delay of the trigger window</description>
      <field name="TriggerWindowOffset" start="0" bits="32" format="signed" unit="ns" scale="4"/>
    </register>     
    
    <register name="TriggerWindowWidth" address="0002" purpose="config">
      <description>Width of the trigger window</description>
      <field name="TriggerWindowWidth" start="0" bits="10" format="unsigned" unit="ns" scale="4"/>
    </register>     
    
    <register name="CtsTriggerDelay" address="0003" purpose="config">
      <description>CTS Trigger Delay</description>
      <field name="CtsTriggerDelay" start="0" bits="10" format="unsigned" unit="ns" scale="4"/>
    </register>     
    
    <register name="ReadoutTimeMax" address="0004" purpose="config">
      <description>Maximal read-out time</description>
      <field name="ReadoutTimeMax" start="0" bits="10" format="unsigned" unit="ns" scale="10"/>
    </register>     
    
    <register name="FpgaTsOffset" address="0005" purpose="config">
      <description>Adds positive offset to FPGA Timestamp</description>
      <field name="FpgaTsOffset" start="0" bits="12" format="unsigned" unit="ns" scale="4"/>
    </register>
    
    <register name="BusyTime" address="0006" purpose="status" mode="r">
      <description>Maximal read-out time</description>
      <field name="BusyTime" start="0" bits="12" format="unsigned" unit="ns" scale="10"/>
    </register>  
    
    <register name="TimestampRef" address="0007" purpose="status" mode="r">
      <description>Internal reference timestamp of current event</description>
      <field name="TimestampRef" start="0" bits="12" format="unsigned" unit="ns" scale="4"/>
    </register>  
    
    <register name="WindowLowerThreshold" address="0008" purpose="status" mode="r">
      <description>Lower timestamp limit of data selection window</description>
      <field name="WindowLowerThreshold" start="0" bits="12" format="unsigned" unit="ns" scale="4"/>
    </register>  
    
    <register name="TSWindowErrorCount" address="0009" purpose="status" mode="r">
      <description>TS Window Error Counter</description>
      <field name="TSWindowErrorCount" start="0" bits="16" format="unsigned"/>
    </register>  
    
    <register name="DataFifoDelay" address="000a" purpose="status" mode="r">
      <description>Current Data-Fifo delay value</description>
      <field name="DataFifoDelay" start="0" bits="7" format="unsigned" unit="ns" scale="32"/>
    </register>

    <register name="ChannelWait" address="000b" purpose="status" mode="r" repeat="4">
      <description>Data channel WAIT Flags</description>
      <field name="ChannelWait" start="0" bits="32" format="bitmask"/>
    </register> 
    
    <register name="ChannelHit" address="000f" purpose="status" mode="r" repeat="4">
      <description>Data channel HIT Flags</description>
      <field name="ChannelHit" start="0" bits="32" format="bitmask"/>
    </register> 
    
    <register name="ChannelDone" address="0013" purpose="status" mode="r" repeat="4">
      <description>Data channel DONE Flags</description>
      <field name="ChannelDone" start="0" bits="32" format="bitmask"/>
    </register>  
    
    <register name="ChannelAllDone" address="0017" purpose="status" mode="r">
      <description>Data channel All-Done Flag</description>
      <field name="ChannelAllDone" start="0" bits="1" format="boolean"/>
    </register>

    <register name="FIFOFull" address="0018" purpose="status" mode="r">
      <description>Event Buffer full Flag</description>
      <field name="FIFOFull" start="0" bits="1" format="boolean"/>
    </register>

    <register name="WaitForData" address="0019" purpose="status" mode="r">
      <description>Readout wait for data time</description>
      <field name="Disable" start="31" bits="1" format="boolean" purpose="config" mode="rw"/>
      <field name="WaitTime" start="0" bits="20" format="unsigned" unit="ns"/>
    </register>

    <register name="NxyterCVT" address="001a" purpose="config" mode="rw">
      <description>Nxyter CVT</description>
      <field name="NxyterCVT" start="0" bits="12" format="unsigned" unit="ns"/>
    </register>
    
    <register name="MinValTime" address="001b" purpose="status" mode="r">
      <description>Minimum Validation Time</description>
      <field name="MinValTime" start="0" bits="20" format="unsigned" unit="ns"/>
    </register>

    <register name="WinLowCtr" address="001c" purpose="status" mode="r">
      <description>Out of Window Low Counter</description>
      <field name="WinLowCtr" start="0" bits="15" format="unsigned"/>
    </register>
    
    <register name="WinHitCtr" address="001d" purpose="status" mode="r">
      <description>Window Hit Counter</description>
      <field name="WinHitCtr" start="0" bits="15" format="unsigned"/>
    </register>
    
    <register name="WinHighCtr" address="001e" purpose="status" mode="r">
      <description>Out of Window High Counter</description>
      <field name="WinHighCtr" start="0" bits="15" format="unsigned"/>
    </register>

    <register name="DataRate" address="001f" purpose="status" mode="r">
      <description>Data Rate being written to Event Buffer in s&lt;sup&gt;-1&lt;/sup&gt;</description>
      <field name="DataRate" start="0" bits="28" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;"/>
    </register>

    <register name="HistLimits" address="0020" purpose="status" mode="rw">
      <description>HistLimits Setup</description>
      <field name="EnableFilter" start="31" bits="1" format="bitmask" />
      <field name="HistLimitsOn" start="30" bits="1" format="bitmask" />
      <field name="HistReset"    start="29" bits="1" format="bitmask" />
      <field name="HistUpperThr" start="15" bits="14" format="unsigned" unit="ns"/>
      <field name="HistLowerThr" start="0"  bits="14" format="unsigned" unit="ns"/>
    </register>
    
    <register name="HistTSRange" address="0021" purpose="config" mode="rw">
      <description>Timestamp Histogram Range (5=16&#956;s 4=8&#956;s 3=4&#956;s 2=2&#956;s 1=1&#956;s)</description>
      <field name="HistTSRange" start="0" bits="3" format="unsigned"/>
    </register>
  </group>
  
  <!-- ##################################################################### -->
  
  <group name="DataReceiver"
         address="0500"  size="24"  purpose="status"  mode="rw"  continuous="true">
    
    <register name="ErrorBits" address="0000" purpose="status" mode="r">
      <description>Status of Error Bits</description>
      <field name="NX_Off"         start="0"  bits="1" format="bitmask" purpose="status" mode="r"/>    
      <field name="FR_Rate"        start="1"  bits="1" format="bitmask" purpose="status" mode="r"/>            
      <field name="NX_Rate"        start="2"  bits="1" format="bitmask" purpose="status" mode="r"/>
      <field name="ADC_Rate"       start="3"  bits="1" format="bitmask" purpose="status" mode="r"/>      
      <field name="Parity"         start="4"  bits="1" format="bitmask" purpose="status" mode="r"/>
      <field name="NX_Sync"        start="5"  bits="1" format="bitmask" purpose="status" mode="r"/>
      <field name="ADC_Err"        start="6"  bits="1" format="bitmask" purpose="status" mode="r"/>
      <field name="ADC_PLL"        start="7"  bits="1" format="bitmask" purpose="status" mode="r"/>
      <field name="ADC_CLK"        start="8"  bits="1" format="bitmask" purpose="status" mode="r"/>
      <field name="ADC_L"          start="9"  bits="1" format="bitmask" purpose="status" mode="r"/>
      <field name="TS_DT"          start="10" bits="1" format="bitmask" purpose="status" mode="r"/>
      <field name="ADC_DT"         start="11" bits="1" format="bitmask" purpose="status" mode="r"/>
      <field name="RS"             start="12" bits="1" format="bitmask" purpose="status" mode="r"/>
    </register>
    
    <register name="ResetStatus" address="0001" purpose="status" mode="r">
      <description>Reset Busy Status, Click to force reset</description>
      <field name="RTimeout" start="1" bits="1" format="bitmask"  purpose="status" mode="r"/>
      <field name="ResetBusy" start="0" bits="1" format="bitmask" purpose="status" mode="rw"/>
    </register>

    <register name="MFrameRate" address="0002" purpose="status" mode="r">
      <description>Merge of Nxyter and ADC Frame Rates, must be 31.25&amp;middot;10&lt;sup&gt;6&lt;/sup&gt;s&lt;sup&gt;-1&lt;/sup&gt;</description>
      <field name="MFrameRate" start="0" bits="27" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;" />
    </register>
    
    <register name="NXFrameRate" address="0003" purpose="status" mode="r">
      <description>Nxyter Timestamp Frame Rate, must be 31.25&amp;middot;10&lt;sup&gt;6&lt;/sup&gt;s&lt;sup&gt;-1&lt;/sup&gt;</description>
      <field name="NXFrameRate" start="0" bits="27" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;" />
    </register>
    
    <register name="ADCFrameRate" address="0004" purpose="status" mode="r">
      <description>ADC Data Frame Rate, must be 31.25&amp;middot;10&lt;sup&gt;6&lt;/sup&gt;s&lt;sup&gt;-1&lt;/sup&gt;</description>
      <field name="ADCFrameRateC" start="0" bits="27" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;" />
      <field name="DisableADC" start="31" bits="1" format="bitmask" mode="rw" />
    </register>
    
    <register name="ParityErrRate" address="0005" purpose="status" mode="r">
      <description>Parity Error Rate, must be 0, &amp;middot;10&lt;sup&gt;6&lt;/sup&gt;s&lt;sup&gt;-1&lt;/sup&gt;</description>
      <field name="ParityErrRate" start="0" bits="27" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;" />
    </register>
    
    <register name="ResetCounter" address="0006" purpose="status" mode="r">
      <description>Reset Handler Counter</description>
      <field name="ResetCounter" start="0" bits="16" format="unsigned" />
    </register>

    <register name="ADCResetCtr" address="0007" purpose="status" mode="r">
      <description>ADC Reset counter</description>
      <field name="ADCResetCtr" start="0" bits="32" format="unsigned"/>
    </register>
   
    <register name="ADCNotLockCounter" address="0008" purpose="status" mode="r">
      <description>ADC Handler not Lock Counter</description>
      <field name="ADCNotLockCounter" start="0" bits="8" format="unsigned" />
    </register>

    <register name="FMergeErrorCtr" address="0009" purpose="status" mode="r">
      <description>Frames Merge Error Counter</description>
      <field name="FMergeErrorCounter" start="0" bits="8" format="unsigned" />
    </register>

    <register name="ResyncCounter" address="000a" purpose="status" mode="r">
      <description>Number of Resyncs</description>
      <field name="ResyncCounter" start="0" bits="12" format="unsigned" />
    </register>

    <register name="ParityErrorCounter" address="000b" purpose="status" mode="r">
      <description>Number of Parity Errors</description>
      <field name="ParityErrorCounter" start="0" bits="32" format="unsigned" errorflag="true" />
    </register>

    <register name="ADCSNotLockCount" address="000c" purpose="status" mode="r">
      <description>ADC Sampling PLL Clock Not Lock Counter</description>
      <field name="ADCSNotLockCount" start="0" bits="32" format="unsigned" errorflag="true" />
    </register>
    
    <register name="PllDPhase" address="000d" purpose="config" mode="rw">
      <description>PLL ADC Sampling Clock DPHASE</description>
      <field name="PllDPhase" start="0" bits="4" format="unsigned" scale="2" unit="ns" />
    </register>
    
    <register name="PllFineDelb" address="000e" purpose="config" mode="rw">
      <description>PLL ADC Sampling Clock FINEDELB</description>
      <field name="PllFineDelb" start="0" bits="4" format="unsigned" scale="125" unit="ps" />
    </register>
 
    <register name="JohnsonCtrSync" address="000f" purpose="config" mode="rw">
      <description>johnson_counter_sync (experts only)</description>
      <field name="JohnsonCtrSync" start="0" bits="2" format="unsigned"/>
    </register>
    
    <register name="TSDelay" address="0010" purpose="config" mode="rw">
      <description>Delay of Timestamp Fifo</description>
      <field name="TSDelayB" start="0" bits="3" format="unsigned" />
      <field name="TSDelayF" start="4" bits="2" format="unsigned" purpose="status" mode="r"/>
    </register>

    <register name="TimestampFifoStatus" address="0011" purpose="status" mode="r">
      <description>Status of the timestamp Fifo</description>
      
      <field name="TSFifoFull" start="0" bits="1" format="boolean" errorflag="true" mode="r">
        <description>Timestamp Fifo full</description>
      </field>  
      
      <field name="TSFifoEmpty" start="1" bits="1" format="boolean" mode="r">
        <description>Timestamp Fifo Empty</description>
      </field>  
      
      <field name="NxFrameSynced" start="31" bits="1" format="boolean" mode="r">
        <description>Synchronized to Nxyter Frame</description>
      </field>        
    </register>   
    
    <register name="ADCBShift" address="0012" purpose="config" mode="rw">
      <description>ADC Bit Shift</description>
      
      <field name="ShiftDir" start="3" bits="1" format="unsigned">
        <description>ADC Bit Shift Direction (0=ror, 1=rol)</description>
      </field>
      <field name="ShiftValue" start="0" bits="3" format="unsigned">
        <description>ADC Bit Shift value</description>    
      </field>
    </register>
    
    <register name="CurrentTimestamp" address="0013" purpose="status" mode="r">
      <description>Current Timestamp Value read from Fifo</description>
      <field name="CurrentTimestamp" start="0" bits="32" format="unsigned" />
    </register>

    <register name="ADCDTErrorCtr" address="0014" purpose="status" mode="r">
      <description>ADC Data Rate Error Counter</description>
      <field name="ADCDTErrorCtr" start="0" bits="11" format="unsigned" />
    </register>

    <register name="TSDTErrorCtr" address="0015" purpose="status" mode="r">
      <description>Timestamp Data Rate Error Counter</description>
      <field name="TSDTErrorCtr" start="0" bits="11" format="unsigned" />
    </register>
    
    <register name="ADCNLockCtr" address="0016" purpose="status" mode="r">
      <description>ADC Not Locked counter</description>
      <field name="ADCNLockCtr" start="0" bits="28" format="unsigned" rate="1" />
    </register>

    <register name="ADCErrorCtr" address="0017" purpose="status" mode="r">
      <description>ADC Error Counter</description>
      <field name="ADCErrorCtr" start="0" bits="28" format="unsigned" rate="1" />
    </register>
    
</group>
  
  <!-- ##################################################################### -->

  <group name="DataValidate"
         address="0120"  size="17"  purpose="status"  mode="r"  continuous="true">
    
    <register name="HitRate" address="0000" purpose="status">
      <description>Total hit rate summed over all channels</description>
      <field name="HitRate" start="0" bits="32" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;"/>
    </register>
    
    <register name="FrameRate" address="0001" purpose="status">
      <description>Rate of Incoming Nxyter + ADC Frames, must be 31.25&amp;middot;10&lt;sup&gt;6&lt;/sup&gt;s&lt;sup&gt;-1&lt;/sup&gt;</description>
      <field name="FrameRate" start="0" bits="32" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;"/>
    </register>

    <register name="PileupRate" address="0002" purpose="status" mode="r">
      <description>Pileup Rate</description>
      <field name="PileupRate" start="0" bits="32" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;" />
    </register>
     
    <register name="OverflowRate" address="0003" purpose="status" mode="r">
      <description>Overflow Rate</description>
      <field name="OverflowRate" start="0" bits="32" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;" />
    </register>
       
    <register name="ADCAverageNum" address="0004" purpose="config" mode="rw">
      <description>Number of Averages, power of two (2^n)</description>
      <field name="ADCAverageNum" start="0" bits="4" format="unsigned" />
    </register>

    <register name="ADCAverage" address="0005" purpose="status" mode="r">
      <description>Average of last valid ADC Values</description>
      <field name="ADCAverage" start="0" bits="12" format="unsigned"/>
    </register>
           
    <register name="ADCTRError" address="0006" purpose="config" mode="rw">
      <description>ADCTR Error Status</description>
      <field name="ADCTRError" start="0" bits="2" format="bitmask"/>
    </register>
        
    <register name="ADCTRErrorRate" address="0007" purpose="status" mode="r">
      <description>ADCTR Error Rate</description>
      <field name="ADCTRErrorRate" start="0" bits="32" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;" />
    </register>

    <register name="ADCTRValue" address="0008" purpose="status" mode="r">
      <description>Average of last Token Return ADC Values</description>
      <field name="ADCTRValue" start="0" bits="12" format="unsigned"/>
    </register>
    

    <register name="ParityErrCtr" address="0009" purpose="status" mode="r">
      <description>Parity Error Counter</description>
      <field name="ParityErrCtr" start="0" bits="15" format="unsigned"/>
    </register>

    
    <register name="ADCTRLimit" address="000a" purpose="config" mode="rw">
      <description>ADCTR Limit</description>
      <field name="ADCTRLimit" start="0" bits="12" format="unsigned"/>
    </register>
    
    <register name="ADCTRErrorCtr" address="000b" purpose="status" mode="r">
      <description>ADCTR Error Counter</description>
      <field name="ADCTRErrorCtr" start="0" bits="12" format="unsigned"/>
    </register>
  
    <register name="PileupCount" address="000c" purpose="status">
      <description>Pileup Counter</description>
      <field name="PileupCount" start="0" bits="16" format="unsigned" />
    </register>

    <register name="OverflowCount" address="000d" purpose="status">
      <description>Number of hit overflows</description>
      <field name="OverflowCount" start="0" bits="16" format="unsigned" />
    </register>
    
    <register name="InvalidFrameCtr" address="000e" purpose="status">
      <description>Number of invalid frames</description>
      <field name="InvalidFrameCtr" start="0" bits="16" format="unsigned" />
    </register>
       
    <register name="ADCTRDebug" address="000f" purpose="config" mode="rw">
      <description>Reserved</description>
      <field name="ADCTRDebug" start="0" bits="1" format="boolean" />
    </register>

    <register name="HitRateCtr" address="0010" purpose="status" mode="r">
      <description>Hit wraparound counter</description>
      <field name="HitRateCtr" start="0" bits="32" format="unsigned" rate="1" />
    </register>

  </group>
  
  <!-- ##################################################################### -->

  <group name="NxyterI2C"
         address="0200" purpose="config"  mode="rw"  continuous="false">

    <group name="NxMainReg"
           address="0050"  size="7"  purpose="config"  mode="rw" continuous="true">
      
      <register name="NxyterClock" address="0000" purpose="config" mode="rw" >
        <description>Nxyter Main Clock enable</description>
        <field name="NxyterClock" start="0" bits="1" format="boolean"/>
      </register> 
      
      <register name="NxPolarity" address="0001" purpose="config" mode="rw" >
        <description>Nxyter Input Polarity (0 = negative, 1 = positive)</description>
        <field name="NxPolarity" start="0" bits="1" format="unsigned"/>
      </register>
      
      <register name="NxTestPol" address="0002" purpose="config" mode="r" >
        <description>Nxyter Testpulse Polarity (1 = negative, 0 = positive)</description>
        <field name="NxTestPol" start="0" bits="1" format="bitmask"/>
      </register>

      <register name="NxTestPulse" address="0003" purpose="config" mode="rw" >
        <description>Nxyter Testpulse enable</description>
        <field name="NxTestPulse" start="0" bits="1" format="boolean"/>
      </register>

      <register name="NxTestTrigger" address="0004" purpose="config" mode="rw" >
        <description>Nxyter Testtrigger enable</description>
        <field name="NxTestTrigger" start="0" bits="1" format="boolean"/>
      </register>
      
      <register name="NxTestChGroup" address="0005" purpose="config" mode="rw" >
        <description>Nxyter Testpulse Channel Group (0=0,4,.. 1=1,5,.. 2=2,6,.. 3=3,7,..)</description>
        <field name="NxTestChGroup" start="0" bits="2" format="unsigned"/>
      </register>
      
      <register name="NXOnline" address="0006" purpose="status" mode="r" >
        <description>I2C Online, i.e. Nxyter is connected</description>
        <field name="NXOnline" start="0" bits="1" format="boolean"/>
      </register>
    </group>
    

    <group name="I2CRegs"
           address="0000"  size="46"  purpose="status"  mode="rw" continuous="true">
      
      <register name="ChannelMask" address="0000" purpose="config" repeat="16">
        <description>0..15: Channel Mask Register</description>
        <field name="Ch0" start="0" bits="1" format="bitmask" purpose="config" mode="rw"/>
        <field name="Ch1" start="1" bits="1" format="bitmask" purpose="config" mode="rw"/>
        <field name="Ch2" start="2" bits="1" format="bitmask" purpose="config" mode="rw"/>
        <field name="Ch3" start="3" bits="1" format="bitmask" purpose="config" mode="rw"/>
        <field name="Ch4" start="4" bits="1" format="bitmask" purpose="config" mode="rw"/>
        <field name="Ch5" start="5" bits="1" format="bitmask" purpose="config" mode="rw"/>
        <field name="Ch6" start="6" bits="1" format="bitmask" purpose="config" mode="rw"/>
        <field name="Ch7" start="7" bits="1" format="bitmask" purpose="config" mode="rw"/>
      </register>
      

      <register name="Icg" address="0010" purpose="config">
        <description>16: Gate Voltage Preamplifier Current Sink (Vcg)</description>
        <field name="Icg" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>

      <register name="IcgFoll" address="0011" purpose="config">
        <description>17: Bias Voltage Shapers (VcgFoll)</description>
        <field name="IcgFoll" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>

      <register name="Vth" address="0012" purpose="config">
        <description>18: Global Threshold of Comparators</description>
        <field name="Vth" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>
      
      <register name="Vbfb" address="0013" purpose="config">
        <description>19: Discharge time of Preamplifier.</description>
        <field name="Vbfb" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>

      <register name="VbiasF" address="0014" purpose="config">
        <description>20: Bias Voltage Fast Shaper</description>
        <field name="VbiasF" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>

      <register name="VbiasS" address="0015" purpose="config">
        <description>21: Bias Voltage Slow Shaper first stage</description>
        <field name="VbiasS" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>
      
      <register name="VbiasS2" address="0016" purpose="config">
        <description>22: Bias Voltage Slow Shaper second stage</description>
        <field name="VbiasS2" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>  

      <register name="VcmVbase" address="0017" purpose="config">
        <description>23: Target Voltage of common mode feedback</description>
        <field name="VcmVbase" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>  
      
      <register name="cal" address="0018" purpose="config">
        <description>24: Strength of internal Testpulse</description>
        <field name="cal" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>  

      <register name="iCOMP" address="0019" purpose="config">
        <description>25: Current of Main Stage of Comparator</description>
        <field name="iCOMP" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>  

      <register name="iDUR" address="001a" purpose="config">
        <description>26: Dead Time of analog channels</description>
        <field name="iDUR" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>  

      <register name="iINV" address="001b" purpose="config">
        <description>27: Current of Output Stage of Comparators</description>
        <field name="iINV" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>  

      <register name="iPDH" address="001c" purpose="config">
        <description>28: Current of Peak Detect and hold Circuit</description>
        <field name="iPDH" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>  

      <register name="iTWC" address="001d" purpose="config">
        <description>29: Current of Time Walk Compensation Circuit</description>
        <field name="iTWC" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>  

      <!--
         <register name="Spare1" address="001e" purpose="status" repeat="2">
           <description>30..31: Spare</description>
           <field name="Spare1" start="0" bits="32" format="bitmask" purpose="config" mode="r"/>
         </register>
         -->
      <register name="Config1" address="0020" purpose="config">
        <description>32: Configuration Register #1</description>
        <field name="TSLSB" start="7" bits="1" format="bitmask" purpose="config" mode="rw">
          <description>Timestamp LSB Select(0: CLK256A, 1:CLK256B</description>
        </field>
        <field name="D128MHz" start="6" bits="1" format="bitmask" purpose="config" mode="rw">
          <description>Disable 128MHz Readout Clock</description>
        </field>
        <field name="D32MHz" start="5" bits="1" format="bitmask" purpose="config" mode="rw">
          <description>Disable 32MHz Readout Clock</description>
        </field>
        <field name="TTSync" start="4" bits="1" format="bitmask" purpose="config" mode="rw">
          <description>TestTrigger Synchronize</description>
        </field>        
        <field name="TTEnable" start="3" bits="1" format="bitmask" purpose="config" mode="r">
          <description>TestTrigger Enable</description>
        </field>
        <field name="TPPolarity" start="2" bits="1" format="bitmask" purpose="config" mode="r">
          <description>TestPulse Polarity (1: negative, 0: positive)</description>
        </field>
        <field name="TPSync" start="1" bits="1" format="bitmask" purpose="config" mode="rw">
          <description>TestPulse Synchronize</description>
        </field>
        <field name="TPEnabled" start="0" bits="1" format="bitmask" purpose="config" mode="r">
          <description>TestPulse Enable</description>
        </field>
      </register>  

      <register name="Config2" address="0021" purpose="status">
        <description>33: Configuration Register #2</description>
        <field name="ReadoutClock" start="3" bits="1" format="bitmask" purpose="status" mode="r">
          <description>Must always be set</description>
        </field>
        <field name="FEPolarity" start="2" bits="1" format="bitmask" purpose="status" mode="r">
          <description>Front End Polarity (0: negative input charge, 1: positive input charge)</description>
        </field>
        <field name="CalSelect" start="0" bits="2" format="unsigned" purpose="status" mode="r">
          <description>Nxyter Testpulse Channel Group (0=0,4,.. 1=1,5,.. 2=2,6,.. 3=3,7,..)</description>
        </field>
      </register>  
      <!--
         <register name="Counter" address="0022" purpose="status" repeat="4">
           <description>34..37: Spare</description>
           <field name="Counter" start="0" bits="32" format="bitmask" purpose="config" mode="r"/>
         </register>
         -->
      <register name="TPDelay" address="0026" purpose="config">
        <description>38: Testpulse Delay</description>
        <field name="TPDelay" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>  

      <register name="TTDelay" address="0027" purpose="config">
        <description>39: Test Trigger Delay</description>
        <field name="TTDelay" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>  
      
      <!--
         <register name="Spare2" address="0028" purpose="status" repeat="3">
           <description>40..42: Spare</description>
           <field name="Spare2" start="0" bits="32" format="bitmask" purpose="config" mode="r"/>
         </register>
         -->     
      <register name="ClkDelay" address="002b" purpose="config" repeat="3">
        <description>43..45: Clock Delay Registers</description>
        <field name="ClkDelay" start="0" bits="8" format="unsigned" purpose="config" mode="rw"/>
      </register>  
    </group>
    
    <register name="UpdateRegI2C" address="0060" purpose="config" mode="rw">
      <description>Update Nxyter I2C Register</description>
      <field name="UpdateRegI2C" start="0" bits="1" format="boolean" purpose="config"/>
    </register>
    
    <register name="UpdateRegDAC" address="0061" purpose="config" mode="rw">
      <description>Update Nxyter DAC Register</description>
      <field name="UpdateRegDAC" start="0" bits="1" format="boolean" purpose="config"/>
    </register>
    
    <register name="UpdateRegBoth" address="0062" purpose="config" mode="rw">
      <description>Update Nxyter I2C and DAC Register</description>
      <field name="UpdateRegBoth" start="0" bits="1" format="boolean" purpose="config" />
    </register>  
  </group>
  
  <!-- ##################################################################### -->

  <group name="NxyterDAC"
         address="0300"  size="129"  purpose="status"  mode="rw" continuous="true">
    
    <register name="DACRegister" address="0000" purpose="config" repeat="129">
      <description>Nxyter DAC Register </description>
      
      <field name="ChannelDown" start="5" bits="1" format="bitmask" purpose="config" mode="rw">
        <description>Channel Down</description>
      </field> 
      
      <field name="TrimValue" start="0" bits="5" format="unsigned" purpose="config" mode="rw">
        <description>DAC Trim Value</description>
      </field> 
    </register>
    
  </group>
  
  <!-- ##################################################################### -->

  <group name="I2CTokens"
         address="0270"  size="14"  purpose="status"  mode="r" continuous="true">
    
    <register name="WriteToken0" address="0000" purpose="status" mode="r" >
      <description>I2C Register Write Token Status 31 .. 0</description>
      <field name="WriteToken0" start="0" bits="32" format="bitmask"/>
    </register>
    <register name="WriteToken1" address="0001" purpose="status" mode="r" >
      <description>I2C Register Write Token Status 45 .. 32</description>
      <field name="WriteToken1" start="0" bits="14" format="bitmask"/>
    </register>
    
    <register name="ReadToken0" address="0002" purpose="status" mode="r" >
      <description>I2C Register Read Token Status 31 .. 0</description>
      <field name="ReadToken0" start="0" bits="32" format="bitmask"/>
    </register>
    <register name="ReadToken1" address="0003" purpose="status" mode="r" >
      <description>I2C Register Read Token Status 45 .. 32</description>
      <field name="ReadToken1" start="0" bits="14" format="bitmask"/>
    </register>
    
    <register name="WriteTokenDAC0" address="0004" purpose="status" mode="r" >
      <description>I2C Register Write Token DAC Status 31 .. 0</description>
      <field name="WriteTokenDAC0" start="0" bits="32" format="bitmask"/>
    </register>
    <register name="WriteTokenDAC1" address="0005" purpose="status" mode="r" >
      <description>I2C Register Write Token DAC Status 63 .. 32</description>
      <field name="WriteTokenDAC1" start="0" bits="32" format="bitmask"/>
    </register>
    <register name="WriteTokenDAC2" address="0006" purpose="status" mode="r" >
      <description>I2C Register Write Token DAC Status 95 .. 64</description>
      <field name="WriteTokenDAC2" start="0" bits="32" format="bitmask"/>
    </register>
    <register name="WriteTokenDAC3" address="0007" purpose="status" mode="r" >
      <description>I2C Register Write Token DAC Status 127 .. 95</description>
      <field name="WriteTokenDAC3" start="0" bits="32" format="bitmask"/>
    </register>
    <register name="WriteTokenDAC4" address="0008" purpose="status" mode="r" >
      <description>I2C Register Write Token DAC Status 128</description>
      <field name="WriteTokenDAC4" start="0" bits="1" format="bitmask"/>
    </register>
    
    <register name="ReadTokenDAC0" address="0009" purpose="status" mode="r" >
      <description>I2C Register Read Token DAC Status 31 .. 0</description>
      <field name="ReadTokenDAC0" start="0" bits="32" format="bitmask"/>
    </register>
    <register name="ReadTokenDAC1" address="000a" purpose="status" mode="r" >
      <description>I2C Register Read Token DAC Status 63 .. 32</description>
      <field name="ReadTokenDAC1" start="0" bits="32" format="bitmask"/>
    </register>
    <register name="ReadTokenDAC2" address="000b" purpose="status" mode="r" >
      <description>I2C Register Read Token DAC Status 95 .. 64</description>
      <field name="ReadTokenDAC2" start="0" bits="32" format="bitmask"/>
    </register>
    <register name="ReadTokenDAC3" address="000c" purpose="status" mode="r" >
      <description>I2C Register Read Token DAC Status 127 .. 95</description>
      <field name="ReadTokenDAC3" start="0" bits="32" format="bitmask"/>
    </register>
    <register name="ReadTokenDAC4" address="000d" purpose="status" mode="r" >
      <description>I2C Register Read Token DAC Status 128</description>
      <field name="ReadTokenDAC4" start="0" bits="1" format="bitmask"/>
    </register>
  </group>
  
  <!-- ##################################################################### -->
  
  <group name="NXStatus"
         address="0103"  size="10"  purpose="status"  mode="rw" continuous="true">

    <register name="ErrorStatus" address="0009" purpose="status" mode="r" >
      <description>Error Status of all Entities</description>
      <field name="EventBuf"  start="2" bits="1" format="bitmask" purpose="status"/>
      <field name="DataValid" start="1" bits="1" format="bitmask" purpose="status"/>
      <field name="DataRec"   start="0" bits="1" format="bitmask" purpose="status"/>
    </register>

    <register name="SetOffline" address="0000" purpose="config" mode="rw" >
      <description>Force Nxyter Offline Mode</description>
      <field name="SetOffline" start="0" bits="1" format="boolean"/>
    </register>

    <register name="I2COnline" address="0001" purpose="status" mode="r" >
      <description>Nxyter I2C Online Status</description>
      <field name="I2COnline" start="0" bits="1" format="boolean"/>
    </register>

    <register name="NxOnline" address="0002" purpose="status" mode="r" >
      <description>Nxyter Online Status</description>
      <field name="NxOnline" start="0" bits="1" format="boolean"/>
    </register>
    
    <register name="MainClkLock" address="0003" purpose="status" mode="rw" >
      <description>Nxyter Main Clock Lock (250 MHz), click to reset</description>
      <field name="MainClkLock" start="0" bits="1" format="boolean"/>
    </register>
    
    <register name="AdcDClkLock" address="0004" purpose="status" mode="r" >
      <description>ADC Data Clock Lock</description>
      <field name="AdcDClkLock" start="0" bits="1" format="boolean"/>
    </register>
    
    <register name="AdcSClkLock" address="0005" purpose="status" mode="r" >
      <description>ADC Sample Clock Lock</description>
      <field name="AdcSClkLock" start="0" bits="1" format="boolean"/>
    </register>

    <register name="MainNotLockCtr" address="0006" purpose="status" mode="r" >
      <description>PLL Nxyter Main Clock NotLock Counter</description>
      <field name="MainNotLockCtr" start="0" bits="16" format="unsigned"/>
    </register>
    
    <register name="AdcDNotLockCtr" address="0007" purpose="status" mode="r" >
      <description>PLL ADC Data Clock NotLock Counter</description>
      <field name="AdcDNotLockCtr" start="0" bits="16" format="unsigned"/>
    </register>

    <register name="AdcSNotLockCtr" address="0008" purpose="status" mode="r" >
      <description>PLL ADC Sample Clock NotLock Counter</description>
      <field name="AdcSNotLockCtr" start="0" bits="16" format="unsigned"/>
    </register>
    
  </group>
  
  <!-- ##################################################################### -->

  <group name="ADCMonitor"
         address="0280"  size="4"  purpose="status"  mode="r" continuous="true">

    <register name="NXSlow" address="0000" purpose="status" mode="r" >
      <description>Nxyter Slow Shaper Pin</description>
      <field name="ErrorSlow" start="12" bits="1" format="bitmask"/>
      <field name="NXSlowVal" start="0" bits="12" format="unsigned" unit="mV"/>
    </register>

    <register name="NXFast" address="0001" purpose="status" mode="r" >
      <description>Nxyter Fast Shaper Pin</description>
      <field name="ErrorFast" start="12" bits="1" format="bitmask"/>
      <field name="NXFastVal" start="0" bits="12" format="unsigned" unit="mV"/>
    </register>

    <register name="FEBTemp" address="0002" purpose="status" mode="r" >
      <description>FEB Temperature Sensor</description>
      <field name="ErrorTemp" start="12" bits="1" format="bitmask"/>
      <field name="FEBTempVal" start="0" bits="12" format="unsigned" unit="mV"/>
    </register>

    <register name="FEBCurrent" address="0003" purpose="status" mode="r" >
      <description>FEB Current</description>    
      <field name="ErrorCurrent" start="12" bits="1" format="bitmask"/>
      <field name="FEBCurrentVal" start="0" bits="12" format="unsigned" unit="mV"/>
    </register>
    
  </group>
  
  <!-- ##################################################################### -->

  <group name="EventBuffer"
         address="0601"  size="4"  purpose="status"  mode="r"  continuous="true">

    <register name="EvtBufDepth" address="0000" purpose="config" mode="rw">
      <description>Evenbuffer Depth (10 ... 4000)</description>
      <field name="EvtBufDepth" start="0" bits="11" format="unsigned" unit="Bytes" scale="4"/>
    </register>

    <register name="EvtBufFlushCtr" address="0001" purpose="status" mode="r">
      <description>Last Eventbuffer Flush Counter</description>
      <field name="EvtBufFlushCtr" start="0" bits="11" format="unsigned" unit="Words"/>
    </register>

    <register name="BufFullRate" address="0002" purpose="status" mode="r">
      <description>Event Buffer Full Flag Rate</description>
      <field name="BufFullRate" start="0" bits="19" format="unsigned" unit="s&lt;sup&gt;-1&lt;/sup&gt;"/>
    </register>

    <register name="Error" address="0003" purpose="status" mode="r">
      <description>Event Buffer Error Status (i.e. Full Rate > 0)</description>
      <field name="Error" start="0" bits="1" format="bitmask"/>
    </register>

  </group>

  <!-- ##################################################################### -->

  <group name="RateHist"
         address="0800"  size="128"  purpose="config"  mode="r" continuous="true">    
    <register name="ChannelHitCtr" address="0000" purpose="status" mode="r" repeat="128">
      <description>Hit Counter per Channel</description>
      <field name="ChannelHitCtr" start="0" bits="32" format="unsigned" rate="1" unit="s&lt;sup&gt;-1&lt;/sup&gt;" />
    </register>
  </group>
  
  <group name="PileupHist"
         address="0900"  size="128"  purpose="config"  mode="r" continuous="true">    
    <register name="ChannelPileupVal" address="0000" purpose="status" mode="r" repeat="128">
      <description>Continuous Pile Up Counter per Channel</description>
      <field name="ChannelPileupVal" start="0" bits="32" format="unsigned" rate="1" unit="s&lt;sup&gt;-1&lt;/sup&gt;" />
    </register>
  </group>

  <group name="OverFlowHist"
         address="0a00"  size="128"  purpose="config"  mode="r" continuous="true">    
    <register name="ChannelOvflVal" address="0000" purpose="status" mode="r" repeat="128">
      <description>Continuous Overflow Counter per Channel</description>
      <field name="ChannelOvflVal" start="0" bits="32" format="unsigned" rate="1" unit="s&lt;sup&gt;-1&lt;/sup&gt;" />
    </register>
  </group>

  <group name="ADCHist"
         address="0b00"  size="129"  purpose="config"  mode="r" continuous="true">    
    <register name="ChannelADCVal" address="0000" purpose="status" mode="r" repeat="128">
      <description>ADC Value Average per Channel</description>
      <field name="ChannelADCVal" start="0" bits="32" format="unsigned"/>
    </register>
    
    <register name="ADCNumAverages" address="0b80" purpose="status" mode="rw">
      <description>Number of Averages per Channel, power of two (2^n)</description>
      <field name="ADCNumAverages" start="0" bits="3" format="unsigned"/>
    </register>
  </group>

  <group name="TSHist"
         address="0c00"  size="512"  purpose="config"  mode="r" continuous="true">    
    <register name="TSVal" address="0000" purpose="status" mode="r" repeat="512">
      <description>Timestamp Hit Counter</description>
      <field name="TSVal" start="0" bits="32" format="unsigned"/>
    </register>
  </group>

</TrbNetEntity>
